---
title: 操作系统复习笔记（更新中）
date: 2025-06-13 17:49:19
tags:
- 复习笔记
- 操作系统
categories:
- 学习笔记
typora-root-url: ./..

---

本笔记根据王道操作系统编写

## 一、导论

### 1.什么是操作系统？

> 操作系统（Operating System， OS）是指控制和管理整个计算机系统的硬件和软件资源，并合理地组织调度计算机的工作和资源的分配，以提供给用户和其他软件方便的接口和环境，它是计算机系统中最基本的系统软件。

操作系统的功能和目标：**向上提供方便易用的服务**

### 2.操作系统的特征

![操作系统的特征](/image/操作系统复习笔记/操作系统的特征.png)

#### Ⅰ.并发

> 并发：指两个或多个事件在同一时间间隔内发生。这些事件**宏观上是同时发生的**，但**微观上是交替发生的**。

易混概念 “并行” 的定义 —— 指两个或多个事件在同一时刻同时发生

#### Ⅱ.共享

> 共享即资源共享，是指系统中的资源可供内存中多个并发执行的进程共同使用。

分为**互斥共享**和**\"同时\"共享**(宏观同时)

#### Ⅲ.虚拟

> 虚拟是指把一个物理上的实体变为若干个逻辑上的对应物。物理实体（前者）是实际存在的，而逻辑上对应物（后者）是用户感受到的。

分为**时分复用**(如虚拟处理器)和空分**复用技术**(如虚拟存储器)

#### Ⅳ.异步

异步是指，在多道程序环境下，允许多个程序并发执行，但由于资源有限，进程的执行不是一贯到底的，而是走走停停，以不可预知的速度向前推进，这就是进程的异步性。

### 3.操作系统的发展与分类

![操作系统的分类](/image/操作系统复习笔记/操作系统的分类.png)

## 二、操作系统是如何运行的？

### 1.操作系统的运行机制

![操作系统的运行机制](/image/操作系统复习笔记/操作系统的运行机制.png)

#### Ⅰ.指令

**指令**是处理器能识别和执行的**最基本的命令**
注：与linux和windows的命令行区分开，本质是交互式命令接口

指令又分为两种指令：**特权指令**和**非特权指令**

#### Ⅱ.状态和切换

![两种指令](/image/操作系统复习笔记/两种指令.png)

操作系统可以使用一条**特权指令**，将PSW的标志位设置为**“用户态”**，CPU在运行程序时遇到非法事件时，会产生**中断信号**，强行变回内核态

![状态转换](/image/操作系统复习笔记/状态转换.png)

### 2.中断和异常

**中断**是让操作系统由用户态转为内核态的**唯一途径**，如果没有中断，CPU就会一直执行一个程序直到结束。

也就是说，没有中断，就没有并发性

#### Ⅰ.内中断（异常、例外）

1.当前程序执行的**指令是非法**的(比如应用程序打算执行特权指令)，或者执行的**指令参数是非法**的(比如除数是0)，就会产生中断信号

2.当应用程序需要使用系统内核服务时，就会执行一条**陷入指令（又叫trap指令、访管指令）**，会引发一个内部中断，让操作系统转向内核态，然后由中断处理程序来执行相关操作

> 系统调用就是通过陷入指令来完成的

注：陷入指令是用户态执行的，**不是特权指令**

#### Ⅱ.外中断（中断）

1.时钟中断：时钟部件每隔一段时间发出一个中断信号

> 时钟中断配合中断处理程序可以实现程序并发执行

2.I/O中断：输入输出设备发出的中断信号

#### Ⅲ.区别

看中断信号的产生**与当前的指令是否有关**，有关即是内中断，无关即是外中断。

![中断和异常](/image/操作系统复习笔记/中断和异常.png)

#### Ⅳ.中断的基本原理

![中断的基本原理](/image/操作系统复习笔记/中断的基本原理.png)

### 3.系统调用

> “系统调用”是操作系统提供给应用程序（程序员/编程人员）使用的接口，可以理解为一种可供应用程序调用的特殊函数，应用程序可以通过系统调用来请求获得操作系统内核的服务

#### Ⅰ.为什么需要系统调用

应用程序通过系统调用请求操作系统的服务。而系统中的各种共享资源都由操作系统内核统一掌管，因此凡是与共享资源有关的操作（如存储分配、I/O操作、文件管理等），都必须通过系统调用的方式向操作系统内核提出服务请求，由操作系统内核代为完成。这样可以**保证系统的稳定性和安全性**，**防止用户进行非法操作**。

#### Ⅱ.分类

![系统调用按功能分类](/image/操作系统复习笔记/系统调用按功能分类.png)

#### Ⅲ.系统调用的过程

![系统调用的过程](/image/操作系统复习笔记/系统调用的过程.png)

## 三、操作系统的体系

### 1.操作系统内核

内核是操作系统最基本、最核心的部分。 实现操作系统内核功能的那些程序就是内核程序。

![操作系统内核组成](/image/操作系统复习笔记/操作系统内核组成.png)

### 2.大内核(宏内核)与微内核对比

**大内核**：将操作系统主要功能模块都作为操作系统内核，运行在核心态

优点：高性能

缺点：内核代码庞大，难以维护

**微内核**：只把最基础的功能留在内核

优点：内核功能少，结构清晰，容易维护

缺点：需要频繁切换内核态与用户态，导致性能下降

### 3.其他体系结构

![计算机体系结构](/image/操作系统复习笔记/计算机体系结构.png)


## 四、操作系统的引导

操作系统的引导：计算机开机时如何启动操作系统的过程

![操作系统引导过程](/image/操作系统复习笔记/操作系统引导过程.png)

## 五、虚拟机

> 虚拟机：使用虚拟化技术，将一台物理机器虚拟化为多台虚拟机器（Virtual Machine, VM），每个虚拟机器都可以独立运行一个操作系统

虚拟机管理程序/虚拟机监控程序/virtual machine monitor(VMM)/Hypervisor

![第一类虚拟机](/image/操作系统复习笔记/第一类虚拟机.jpg)

> 通过将CPU时间片划分，可以把一个单核CPU虚拟为多核CPU

![第二类虚拟机](/image/操作系统复习笔记/第二类虚拟机.jpg)

![两类虚拟机的对比](/image/操作系统复习笔记/两类虚拟机的对比.png)

## 六、进程

### 1.进程是什么？

#### Ⅰ.**进程**和**程序**的区别：

程序：是静态的，就是个存放在磁盘里的可执行文件，就是一系列的**指令集合**。
进程（Process）：是动态的，是程序的一次**执行过程**，同一个程序多次执行会对应多个进程。

#### Ⅱ.操作系统怎么区分不同的进程？

操作系统会在创建线程时分配一个唯一的进程ID(PID)

#### Ⅲ.进程信息存放在哪里？

进程信息(比如进程ID，进程占用内存大小，进程占用CPU时间等等进程相关的信息)都被保存到一个数据结构PCB(Process Control Block，进程控制块)中。

![进程控制块](/image/操作系统复习笔记/进程控制块.png)

#### Ⅳ.程序运行过程

![程序运行过程](/image/操作系统复习笔记/程序运行过程.png)

#### Ⅴ.进程的组成

![进程的组成](/image/操作系统复习笔记/进程的组成.jpg)

#### Ⅵ.进程的特征

![进程的特征](/image/操作系统复习笔记/进程的特征.png)

### 2.进程的状态转换

#### Ⅰ.转换过程

![进程的状态转换](/image/操作系统复习笔记/进程的状态转换.png)

#### Ⅱ.进程的状态

![进程的状态](/image/操作系统复习笔记/进程的状态.jpg)

#### Ⅲ.进程的组织

![进程的组织](/image/操作系统复习笔记/进程的组织.png)

![进程的组织(链接方式)](/image/操作系统复习笔记/进程的组织(链接方式).png)

### 3.进程控制

> 进程控制的主要功能是对系统中的所有进程实施有效的管理，它具有创建新进程、撤销已有进程、实现进程状态转换等功能。

简而言之，进程控制就是要**实现进程的状态转换**

#### Ⅰ.如何实现进程控制？

使用**原语**进行控制

> 原语由若干条指令组成的程序段，用来实现特定功能，**执行过程中不可被中断**，是操作系统核心的组成部分（由一组程序模块构成，非进程 ），常驻内存，通常在管态下执行。

原语具有原子性(可以使用**开中断指令**和**关中断指令**这两个特权指令来实现原子性)

![中断的过程](/image/操作系统复习笔记/中断的过程.jpg)

#### Ⅱ.进程控制相关的原语(理解为主,不需要强记)

- 进程的创建

![进程控制相关的原语](/image/操作系统复习笔记/进程控制相关的原语.jpg)

- 进程的终止

![进程控制相关的原语2](/image/操作系统复习笔记/进程控制相关的原语2.jpg)

- 进程的阻塞和呼唤

![进程控制相关的原语3](/image/操作系统复习笔记/进程控制相关的原语3.jpg)

进程的阻塞和呼唤原语是**成对出现**的

- 进程的切换

![进程控制相关的原语4](/image/操作系统复习笔记/进程控制相关的原语4.png)

#### Ⅲ.程序的执行过程

![程序的执行过程](/image/操作系统复习笔记/程序的执行过程.png)

**保存上下文:**

进程切换时会把相关的**寄存器的数据保存在PCB**中,比如PC,IR等寄存器,恢复时再把数据重新写回

### 4.进程通信

#### Ⅰ.为什么进程通信需要操作系统来支持?

进程是**分配系统资源的单位**(包括内存地址空间)，因此各进程拥有的内存地址空间**相互独立**。

![独立内存地址空间](/image/操作系统复习笔记/独立内存地址空间.png)

为了保证安全，一个进程**不能直接访问**另一个进程的地址空间。

#### Ⅱ.进程通信的类型

- 共享存储

  > 1. 基于存储区的共享：操作系统在内存中划出一块共享存储区，数据的形式、存放位置都由通信进程控制，而不是操作系统。这种共享方式速度很快，是一种高级通信方式。
  >
  > 2. 基于数据结构的共享：比如共享空间里只能放一个长度为10的数组。这种共享方式速度慢、限制多，是一种低级通信方式。
  >
  > ![共享存储](/image/操作系统复习笔记/共享存储.png)
  >
  > 为了避免出错，各个进程对共享空间的访问是**互斥的**，各个进程可以通过操作系统内核提供的同步互斥工具（如P，V操作）

- 消息传递

  > 进程间的数据交换以格式化的消息（Message）为单位。进程通过操作系统提供的“发送消息/接收消息”两个原语进行数据交换。
  >
  > ![消息传递](/image/操作系统复习笔记/消息传递.png)
  >
  > 1. 直接消息传递
  >    ![直接消息传递](/image/操作系统复习笔记/直接消息传递.png)
  > 2. 间接消息传递
  >    ![间接消息传递](/image/操作系统复习笔记/间接消息传递.png)

- 管道通信

  > 1. “管道”是一个特殊的共享文件，又名pipe文件。其实就是在内存中开辟一个大小固定的的缓存缓冲区
  >
  > 2. 本质上是一个**循环队列**，遵循先进先出的原则
  >
  > 3. 所以管道是一个**半双工通信**，某一时间只能实现**单向**的数据传输，如果要实现双向同时通信，需要创建两个管道。
  > 4. 当管道**写满**时，**写进程**将阻塞，直到读进程把数据读走；同理当管道**读空**时，**读进程**将阻塞，直到写进程往管道写入数据。
  > 5. 管道中的数据**一旦被读出，就彻底消失**。因此，当多个进程读同一个管道时，可能会错乱。对此，通常有两种解决方案：①一个管道允许多个写进程，一个读进程（2014年408真题高教社官方答案）；②允许有多个写进程，多个读进程，但系统会让各个读进程轮流从管道中读数据（Linux的方案）。

更新中，敬请期待……
