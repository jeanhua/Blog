---
title: åšå®¢åœ¨äº‘æœåŠ¡å™¨å’Œgithubä¹‹é—´çš„åŒæ­¥
date: 2024-09-14 23:05:15
tags:
- æœåŠ¡å™¨
- åšå®¢
- ssh
- python
categories:
- æ–¹æ³•è®º
---

## åç»­ï¼š

**ä¸‹é¢çš„æ–¹æ³•æ¯”è¾ƒæ…¢ï¼Œå¯ä»¥åœ¨æœåŠ¡å™¨ç«¯éƒ¨ç½²ä¸€ä¸ªwebç›‘å¬ï¼Œä½¿ç”¨githubçš„webhookè‡ªåŠ¨è§¦å‘æ›´æ–°**

å¯æŸ¥çœ‹æ­¤ç¯‡ï¼š

[èŠ±äº†4ä¸ªå°æ—¶ï¼Œå®ç°äº†åšå®¢è‡ªåŠ¨æ„å»ºè„šæœ¬(golang) - jeanhua's blog](https://blog.jeanhua.cn/2025/05/04/36859ed8e5ea/)

## å…ˆå‰ï¼š

åšå®¢æ¡†æ¶ **hexo**ï¼Œç½‘é¡µæœåŠ¡å™¨ **apache2**

å› ä¸ºæˆ‘çš„åšå®¢æ˜¯æ”¾åœ¨äº‘æœåŠ¡ä¸Šçš„ï¼Œç„¶ååˆå¸Œæœ›åœ¨GitHubä¸Šé¢åŒæ­¥ï¼Œä¼ ç»Ÿçš„åŠæ³•æ˜¯ä½¿ç”¨gitæŠŠpublicé‡Œé¢çš„æ–‡ä»¶æ”¾åˆ°GitHubä¸Šé¢ï¼Œç„¶åæ‰‹åŠ¨å°†æ–‡ä»¶å¤åˆ¶åˆ°äº‘æœåŠ¡ä¸Šï¼Œè¿™å°±æœ‰ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯å½“æ–‡ç« åˆ é™¤çš„æ—¶å€™ä¼šå¯¼è‡´åˆ ä¸æ‰ï¼ŒåŒæ—¶ä¹Ÿå¾ˆç¹æ‚ã€‚

---

ç½‘ä¸Šæœ‰çš„åŠæ³•æ™®éæ˜¯åœ¨äº‘æœåŠ¡ä¸Šé¢å¼„ä¸ªgitä»“åº“ï¼Œæ€»ä¹‹ä¸€å †**å¿ƒçƒ¦æ„ä¹±**çš„é…ç½®ï¼Œäºæ˜¯æˆ‘åœ¨æƒ³æœ‰æ²¡æœ‰æ›´**ç®€å•**çš„åŠæ³•

ğŸ¤£**è¿˜çœŸæœ‰**

åªè¦æœ¬åœ°ä»“åº“pushåˆ°githubï¼Œç„¶åäº‘æœåŠ¡å™¨pullä¸€ä¸‹ä¸å°±è¡Œäº†ï¼Œç›´æˆªäº†å½“

ä½†æ˜¯æ‰‹åŠ¨pushç„¶åpullç¡®å®ä¹Ÿéº»çƒ¦

pythonå¯åŠ¨ï¼

```python
import paramiko
import os

# å¤„ç†æœ¬åœ°æ•°æ®
with open("do.bat",'w',encoding='utf-8') as f:
    f.write("hexo clean && hexo g && hexo deploy") #ä¸çŸ¥é“ä¸ºä»€ä¹ˆpythonçš„os.system()ä¼šæŠ¥é”™ï¼Œæ‰€ä»¥å†™ä¸€ä¸ªbatç®—äº†
    f.close()

os.system(".\\do.bat")
print("æœ¬åœ°å¤„ç†å®Œæˆ")
# SSHè¿æ¥ä¿¡æ¯
hostname = '192.168.1.1' #è¿™é‡Œå¡«å†™æœåŠ¡å™¨ip
port = 22  # é»˜è®¤SSHç«¯å£æ˜¯22ï¼Œæ ¹æ®å®é™…æƒ…å†µä¿®æ”¹
username = 'root'#è¿™é‡Œæ¢æˆè´¦æˆ·
password = '******'#è¿™é‡Œæ¢æˆä½ çš„äº‘æœåŠ¡å™¨å¯†ç 
command = 'cd /var/www/blog/ && git pull origin main' #æ¢æˆäº‘æœåŠ¡å¯¹åº”çš„ä»“åº“åœ°å€

# åˆ›å»ºSSHå¯¹è±¡
ssh = paramiko.SSHClient()

# å…è®¸è¿æ¥ä¸åœ¨know_hostsæ–‡ä»¶ä¸­çš„ä¸»æœº
ssh.set_missing_host_key_policy(paramiko.AutoAddPolicy())

# è¿æ¥æœåŠ¡å™¨
ssh.connect(hostname, port, username, password)

# æ‰§è¡Œå‘½ä»¤
stdin, stdout, stderr = ssh.exec_command(command)
print("è¾“å‡ºï¼š", stdout.read().decode())
print("é”™è¯¯ï¼š", stderr.read().decode())

# å…³é—­è¿æ¥
ssh.close()
print("å®Œæˆ")
```

å®Œå·¥ï¼

